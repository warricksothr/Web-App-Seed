define(["jquery"],function(e){return{imageDir:"assets/img/",templateDir:"app/templates/",markdownDir:"app/markdown/",seedUid:Math.floor(100001*Math.random()),getNextUid:function(){return this.seedUid+=1},packageData:function(e){return e="undefined"!=typeof e?e:{},"undefined"!=typeof e.packaged&&"undefined"!=typeof e.data&&"undefined"!=typeof e.util?e:{packaged:!0,data:e,util:this}},saveDataToSession:function(e,t){sessionStorage.setItem(t,JSON.stringify(e))},loadDataFromSession:function(e){var t=JSON.parse(sessionStorage.getItem(e)),n=t.util;return t.util=this,t.util.seedUid=n.seedUid,t},saveDataToLocalStorage:function(e,t){localStorage.setItem(t,JSON.stringify(e))},loadDataFromLocalStorage:function(e){var t=JSON.parse(localStorage.getItem(e));return t.util=this,t},exportGlobal:function(e,t,n){if(n="undefined"!=typeof n?n:!1,"undefined"==typeof window)throw new Error("Unkown runtime environment. Currently only browsers are supported.");("undefined"==typeof window[e]||n===!0)&&(window[e]=t)},renderTemplate:function(t,n,i){n=this.packageData(n),i="undefined"!=typeof n?i:e("#content")[0];var r="doT!"+this.templateDir+t.trim();require([r],function(t){e(i).html(t(n))})},renderMarkdown:function(t,n){var i=this.packageData();n="undefined"!=typeof i?n:e("#content")[0];var r="mdown!"+this.markdownDir+t;require([r],function(t){e(n).html(t)})},domForExposingCurrentData:function(t,n,i){i="undefined"!=typeof i?i:!1,n="undefined"!=typeof n?n:"it",t="undefined"!=typeof t?t:"it";var r=e('<script>require(["app/util"], function(util) { util.exportGlobal("'+n+'",util.loadDataFromSession("'+t+'"),'+i+"); });</script>");return e(r)[0].outerHTML},domForImage:function(t,n,i,r){r="undefined"!=typeof r?r:this.getNextUid();var o="image!"+this.imageDir+t,a="img-"+t.split("/").join("-").split(".")[0]+"-"+r,s=e('<div id="'+a+'"></div>'),d="";"undefined"!=typeof n&&(d="$(image).width("+n+");");var u="";"undefined"!=typeof i&&(u="$(image).height("+i+");");var p=e('<script>require(["'+o+'","jquery"], function(image, $) {$("#'+a+'").each( function() {'+d+u+" $(this).append(image); })});</script>");return s.append(p),e(s)[0].outerHTML},domForTemplateButton:function(t,n,i,r,o,a){i="undefined"!=typeof i?i:t,r="undefined"!=typeof r?r:"button",o="undefined"!=typeof o?o:"#content",a="undefined"!=typeof a?a:this.getNextUid();var s="tmpl-"+t.split("/").join("-").split(".")[0]+"-"+a,d=e('<div id="'+s+'"></div>');return e(d).append('<button class="'+r+'" onclick="'+n+".util.renderTemplate('"+t+"',"+n+",'"+o+"');\">"+i+"</button>"),e(d)[0].outerHTML}}});