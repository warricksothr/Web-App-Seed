define(["require","exports"],function(require,exports){var t;return t="object"==typeof exports&&"function"==typeof require?exports:{},function(){function e(t){return t}function n(){return!1}function i(){}function r(){}i.prototype={chain:function(t,n){var i=this[t];if(!i)throw new Error("unknown hook "+t);this[t]=i===e?n:function(t){return n(i(t))}},set:function(t,e){if(!this[t])throw new Error("unknown hook "+t);this[t]=e},addNoop:function(t){this[t]=e},addFalse:function(t){this[t]=n}},t.HookCollection=i,r.prototype={set:function(t,e){this["s_"+t]=e},get:function(t){return this["s_"+t]}},t.Converter=function(){function t(t){return t=t.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(t,e,n,i,r,o){return e=e.toLowerCase(),P.set(e,E(n)),r?i:(o&&M.set(e,o.replace(/"/g,"&quot;")),"")})}function e(t){return t=t.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,n),t=t.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,n),t=t.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,n),t=t.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,n),t=t.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,n)}function n(t,e){var n=e;return n=n.replace(/^\n+/,""),n=n.replace(/\n+$/g,""),n="\n\n~K"+(D.push(n)-1)+"K\n\n"}function o(t,n){t=h(t);var i="<hr />\n";return t=t.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,i),t=t.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,i),t=t.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,i),t=d(t),t=m(t),t=x(t),t=e(t),t=$(t,n)}function s(t){return t=y(t),t=a(t),t=S(t),t=l(t),t=u(t),t=k(t),t=t.replace(/~P/g,"://"),t=E(t),t=w(t),t=t.replace(/  +\n/g," <br>\n")}function a(t){var e=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return t=t.replace(e,function(t){var e=t.replace(/(.)<\/?code>(?=.)/g,"$1`");return e=q(e,"!"==t.charAt(1)?"\\`*_/":"\\`*_")})}function u(t){return t=t.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,c),t=t.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,c),t=t.replace(/(\[([^\[\]]+)\])()()()()()/g,c)}function c(t,e,n,i,r,o,s,a){void 0==a&&(a="");var u=e,c=n.replace(/:\/\//g,"~P"),l=i.toLowerCase(),p=r,h=a;if(""==p)if(""==l&&(l=c.toLowerCase().replace(/ ?\n/g," ")),p="#"+l,void 0!=P.get(l))p=P.get(l),void 0!=M.get(l)&&(h=M.get(l));else{if(!(u.search(/\(\s*\)$/m)>-1))return u;p=""}p=j(p),p=q(p,"*_");var d='<a href="'+p+'"';return""!=h&&(h=f(h),h=q(h,"*_"),d+=' title="'+h+'"'),d+=">"+c+"</a>"}function l(t){return t=t.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,p),t=t.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,p)}function f(t){return t.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function p(t,e,n,i,r,o,s,a){var u=e,c=n,l=i.toLowerCase(),p=r,h=a;if(h||(h=""),""==p){if(""==l&&(l=c.toLowerCase().replace(/ ?\n/g," ")),p="#"+l,void 0==P.get(l))return u;p=P.get(l),void 0!=M.get(l)&&(h=M.get(l))}c=q(f(c),"*_[]()"),p=q(p,"*_");var d='<img src="'+p+'" alt="'+c+'"';return h=f(h),h=q(h,"*_"),d+=' title="'+h+'"',d+=" />"}function h(t){return t=t.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(t,e){return"<h1>"+s(e)+"</h1>\n\n"}),t=t.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(t,e){return"<h2>"+s(e)+"</h2>\n\n"}),t=t.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(t,e,n){var i=e.length;return"<h"+i+">"+s(n)+"</h"+i+">\n\n"})}function d(t){t+="~0";var e=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return N?t=t.replace(e,function(t,e,n){var i=e,r=n.search(/[*+-]/g)>-1?"ul":"ol",o=g(i,r);return o=o.replace(/\s+$/,""),o="<"+r+">"+o+"</"+r+">\n"}):(e=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,t=t.replace(e,function(t,e,n,i){var r=e,o=n,s=i.search(/[*+-]/g)>-1?"ul":"ol",a=g(o,s);return a=r+"<"+s+">\n"+a+"</"+s+">\n"})),t=t.replace(/~0/,"")}function g(t,e){N++,t=t.replace(/\n{2,}$/,"\n"),t+="~0";var n=F[e],i=new RegExp("(^[ \\t]*)("+n+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+n+")[ \\t]+))","gm"),r=!1;return t=t.replace(i,function(t,e,n,i){var a=i,u=/\n\n$/.test(a),c=u||a.search(/\n{2,}/)>-1;return c||r?a=o(T(a),!0):(a=d(T(a)),a=a.replace(/\n$/,""),a=s(a)),r=u,"<li>"+a+"</li>\n"}),t=t.replace(/~0/g,""),N--,t}function m(t){return t+="~0",t=t.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(t,e,n){var i=e,r=n;return i=b(T(i)),i=_(i),i=i.replace(/^\n+/g,""),i=i.replace(/\n+$/g,""),i="<pre><code>"+i+"\n</code></pre>","\n\n"+i+"\n\n"+r}),t=t.replace(/~0/,"")}function v(t){return t=t.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(D.push(t)-1)+"K\n\n"}function y(t){return t=t.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(t,e,n,i){var r=i;return r=r.replace(/^([ \t]*)/g,""),r=r.replace(/[ \t]*$/g,""),r=b(r),r=r.replace(/:\/\//g,"~P"),e+"<code>"+r+"</code>"})}function b(t){return t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=q(t,"*_{}[]\\",!1)}function w(t){return t=t.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4"),t=t.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4")}function x(t){return t=t.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(t,e){var n=e;return n=n.replace(/^[ \t]*>[ \t]?/gm,"~0"),n=n.replace(/~0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=o(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(t,e){var n=e;return n=n.replace(/^  /gm,"~0"),n=n.replace(/~0/g,"")}),v("<blockquote>\n"+n+"\n</blockquote>")})}function $(t,e){t=t.replace(/^\n+/g,""),t=t.replace(/\n+$/g,"");for(var n=t.split(/\n{2,}/g),i=[],r=/~K(\d+)K/,o=n.length,a=0;o>a;a++){var u=n[a];r.test(u)?i.push(u):/\S/.test(u)&&(u=s(u),u=u.replace(/^([ \t]*)/g,"<p>"),u+="</p>",i.push(u))}if(!e){o=i.length;for(var a=0;o>a;a++)for(var c=!0;c;)c=!1,i[a]=i[a].replace(/~K(\d+)K/g,function(t,e){return c=!0,D[e]})}return i.join("\n\n")}function E(t){return t=t.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),t=t.replace(/<(?![a-z\/?\$!])/gi,"&lt;")}function S(t){return t=t.replace(/\\(\\)/g,A),t=t.replace(/\\([`*_{}\[\]()>#+-.!])/g,A)}function k(t){t=t.replace(/(^|\s)(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\]])($|\W)/gi,"$1<$2$3>$4");var e=function(t,e){return'<a href="'+e+'">'+O.plainLinkText(e)+"</a>"};return t=t.replace(/<((https?|ftp):[^'">\s]+)>/gi,e)}function C(t){return t=t.replace(/~E(\d+)E/g,function(t,e){var n=parseInt(e);return String.fromCharCode(n)})}function T(t){return t=t.replace(/^(\t|[ ]{1,4})/gm,"~0"),t=t.replace(/~0/g,"")}function _(t){if(!/\t/.test(t))return t;var e,n=["    ","   ","  "," "],i=0;return t.replace(/[\n\t]/g,function(t,r){return"\n"===t?(i=r+1,t):(e=(r-i)%4,i=r+1,n[e])})}function j(t){if(!t)return"";var e=t.length;return t.replace(R,function(n,i){return"~D"==n?"%24":":"!=n||i!=e-1&&!/[0-9\/]/.test(t.charAt(i+1))?"%"+n.charCodeAt(0).toString(16):":"})}function q(t,e,n){var i="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(i="\\\\"+i);var r=new RegExp(i,"g");return t=t.replace(r,A)}function A(t,e){var n=e.charCodeAt(0);return"~E"+n+"E"}var O=this.hooks=new i;O.addNoop("plainLinkText"),O.addNoop("preConversion"),O.addNoop("postConversion");var P,M,D,N;this.makeHtml=function(n){if(P)throw new Error("Recursive call to converter.makeHtml");return P=new r,M=new r,D=[],N=0,n=O.preConversion(n),n=n.replace(/~/g,"~T"),n=n.replace(/\$/g,"~D"),n=n.replace(/\r\n/g,"\n"),n=n.replace(/\r/g,"\n"),n="\n\n"+n+"\n\n",n=_(n),n=n.replace(/^[ \t]+$/gm,""),n=e(n),n=t(n),n=o(n),n=C(n),n=n.replace(/~D/g,"$$"),n=n.replace(/~T/g,"~"),n=O.postConversion(n),D=M=P=null,n};var F={ol:"\\d+[.]",ul:"[*+-]"},R=/(?:["'*()[\]:]|~D)/g}}(),new t.Converter});